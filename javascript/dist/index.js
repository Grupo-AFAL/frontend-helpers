var e=require("stimulus");function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var n=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).closeDropdowns=function(){t.element.classList.remove("is-active")},t}t(i,e);var n=i.prototype;return n.connect=function(){document.addEventListener("click",this.closeDropdowns)},n.disconnect=function(){document.removeEventListener("click",this.closeDropdowns)},n.toggleMenu=function(e){e.stopPropagation(),e.preventDefault(),this.element.classList.toggle("is-active")},i}(e.Controller),r=function(e){function i(){return e.apply(this,arguments)||this}t(i,e);var n=i.prototype;return n.connect=function(){this.fieldsSelector=this.data.get("selector"),this.removeDuplicates=this.data.get("removeDuplicates"),this.isAtMaximumSize()&&this.buttonTarget.setAttribute("disabled",!0)},n.addFields=function(e){if(e.preventDefault(),this.isAtMaximumSize())return!1;this.setSize(this.getSize()+1);var t=this.removeDuplicates?this.templateFragmentWithoutDuplicates():this.templateFragment(),i=t.querySelector("[data-position]");i&&(i.value=this.getSize()),this.containerTarget.appendChild(t),this.isAtMaximumSize()&&this.buttonTarget.setAttribute("disabled",!0)},n.removeFields=function(e){e.preventDefault(),this.setSize(this.getSize()-1);var t,i,n=e.target.closest(this.fieldsSelector);n.style.display="none",i=function(e){"hidden"!==e.type&&e.remove()},(t=n).querySelectorAll("input").forEach(i),t.querySelectorAll("textarea").forEach(i),t.querySelectorAll("select").forEach(i),n.querySelector(".destroy-flag").value=!0,this.hasButtonTarget&&this.buttonTarget.hasAttribute("disabled")&&this.buttonTarget.removeAttribute("disabled")},n.moveUp=function(e){e.preventDefault();var t=e.target.closest(this.fieldsSelector),i=function(e,t){var i=e.previousElementSibling;if(!i)return null;for(;!i.matches(t);)if(!(i=i.previousElementSibling))return null;return i}(t,this.fieldsSelector);this.swapElements(t,i),this.resetPositionValues()},n.moveDown=function(e){e.preventDefault();var t=e.target.closest(this.fieldsSelector),i=function(e,t){var i=e.nextElementSibling;if(!i)return null;for(;!i.matches(t);)if(!(i=i.nextElementSibling))return null;return i}(t,this.fieldsSelector);this.swapElements(t,i),this.resetPositionValues()},n.swapElements=function(e,t){var i,n;null!=t&&(n=t.nextElementSibling,(i=e.parentNode).insertBefore(t,e.nextElementSibling),i.insertBefore(e,n))},n.resetPositionValues=function(){this.element.querySelectorAll(this.fieldsSelector).forEach(function(e,t){e.querySelector("[data-position]").value=t+1})},n.templateFragment=function(){return i=this.templateTarget,n=/new_record/g,o=Math.floor(100*Math.random()+1),r=(new Date).getTime().toString()+o,e=i.innerHTML.replace(n,r),(t=document.createElement("template")).innerHTML=e,t.content;var e,t,i,n,r,o},n.templateFragmentWithoutDuplicates=function(){var e=Array.from(this.element.querySelectorAll(this.fieldsSelector+" select")).map(function(e){return e.value}),t=this.templateFragment();return t.querySelectorAll("select option").forEach(function(t){e.includes(t.value)&&t.remove()}),t},n.dropdownOptionsSize=function(){return this.templateFragment().querySelectorAll("select option").length},n.isAtMaximumSize=function(){return this.removeDuplicates&&this.dropdownOptionsSize()===this.getSize()},n.getSize=function(){return parseInt(this.data.get("size"))},n.setSize=function(e){this.data.set("size",e)},i}(e.Controller);r.targets=["template","container","button"],exports.DropdownController=n,exports.DynamicFieldsController=r;
//# sourceMappingURL=index.js.map
