!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("stimulus")):"function"==typeof define&&define.amd?define(["exports","stimulus"],t):t((e||self).frontendHelpers={},e.stimulus)}(this,function(e,t){function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).closeDropdowns=function(){t.element.classList.remove("is-active")},t}n(t,e);var i=t.prototype;return i.connect=function(){document.addEventListener("click",this.closeDropdowns)},i.disconnect=function(){document.removeEventListener("click",this.closeDropdowns)},i.toggleMenu=function(e){e.stopPropagation(),e.preventDefault(),this.element.classList.toggle("is-active")},t}(t.Controller),o=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var i=t.prototype;return i.connect=function(){this.fieldsSelector=this.data.get("selector"),this.removeDuplicates=this.data.get("removeDuplicates"),this.isAtMaximumSize()&&this.buttonTarget.setAttribute("disabled",!0)},i.addFields=function(e){if(e.preventDefault(),this.isAtMaximumSize())return!1;this.setSize(this.getSize()+1);var t=this.removeDuplicates?this.templateFragmentWithoutDuplicates():this.templateFragment(),n=t.querySelector("[data-position]");n&&(n.value=this.getSize()),this.containerTarget.appendChild(t),this.isAtMaximumSize()&&this.buttonTarget.setAttribute("disabled",!0)},i.removeFields=function(e){e.preventDefault(),this.setSize(this.getSize()-1);var t,n,i=e.target.closest(this.fieldsSelector);i.style.display="none",n=function(e){"hidden"!==e.type&&e.remove()},(t=i).querySelectorAll("input").forEach(n),t.querySelectorAll("textarea").forEach(n),t.querySelectorAll("select").forEach(n),i.querySelector(".destroy-flag").value=!0,this.hasButtonTarget&&this.buttonTarget.hasAttribute("disabled")&&this.buttonTarget.removeAttribute("disabled")},i.moveUp=function(e){e.preventDefault();var t=e.target.closest(this.fieldsSelector),n=function(e,t){var n=e.previousElementSibling;if(!n)return null;for(;!n.matches(t);)if(!(n=n.previousElementSibling))return null;return n}(t,this.fieldsSelector);this.swapElements(t,n),this.resetPositionValues()},i.moveDown=function(e){e.preventDefault();var t=e.target.closest(this.fieldsSelector),n=function(e,t){var n=e.nextElementSibling;if(!n)return null;for(;!n.matches(t);)if(!(n=n.nextElementSibling))return null;return n}(t,this.fieldsSelector);this.swapElements(t,n),this.resetPositionValues()},i.swapElements=function(e,t){var n,i;null!=t&&(i=t.nextElementSibling,(n=e.parentNode).insertBefore(t,e.nextElementSibling),n.insertBefore(e,i))},i.resetPositionValues=function(){this.element.querySelectorAll(this.fieldsSelector).forEach(function(e,t){e.querySelector("[data-position]").value=t+1})},i.templateFragment=function(){return n=this.templateTarget,i=/new_record/g,o=Math.floor(100*Math.random()+1),r=(new Date).getTime().toString()+o,e=n.innerHTML.replace(i,r),(t=document.createElement("template")).innerHTML=e,t.content;var e,t,n,i,r,o},i.templateFragmentWithoutDuplicates=function(){var e=Array.from(this.element.querySelectorAll(this.fieldsSelector+" select")).map(function(e){return e.value}),t=this.templateFragment();return t.querySelectorAll("select option").forEach(function(t){e.includes(t.value)&&t.remove()}),t},i.dropdownOptionsSize=function(){return this.templateFragment().querySelectorAll("select option").length},i.isAtMaximumSize=function(){return this.removeDuplicates&&this.dropdownOptionsSize()===this.getSize()},i.getSize=function(){return parseInt(this.data.get("size"))},i.setSize=function(e){this.data.set("size",e)},t}(t.Controller);o.targets=["template","container","button"],e.DropdownController=r,e.DynamicFieldsController=o});
//# sourceMappingURL=index.umd.js.map
